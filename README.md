# Barndoor Star Tracker

Астротрекер типа barndoor с прямой шпилькой (равнобедренный треугольник).

## Оборудование

- **Контроллер**: M5Stack Atom Lite
- **Двигатель**: 28BYJ-48 (модифицирован в биполярный) с редуктором 63.68395:1
- **Драйвер**: DRV8825 с микрошагом 1/32
- **Шпилька**: М6 стандартная (шаг 1мм)
- **Плечо**: 200мм (настраивается в коде)

## Подключение

### Пины управления DRV8825:
- **STEP**: GPIO 33
- **DIR**: GPIO 23
- **MICROSTEP_EN**: GPIO 19 (все джамперы MS1, MS2, MS3 подключены к этому пину)

### Кнопка:
- Встроенная кнопка Atom Lite (GPIO 39)

### RGB LED:
- Встроенный RGB светодиод Atom Lite

## Настройка Arduino IDE

1. Установите поддержку ESP32:
   - File → Preferences → Additional Boards Manager URLs
   - Добавьте: `https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json`
   - Tools → Board → Boards Manager → найдите "ESP32" и установите

2. Установите библиотеку M5Atom:
   - Sketch → Include Library → Manage Libraries
   - Найдите "M5Atom" и установите

3. Настройте плату:
   - Tools → Board → ESP32 Arduino → M5Stack-ATOM
   - Tools → Port → выберите COM порт вашего устройства
   - Tools → Upload Speed → 115200 (или выше, если поддерживается)

## Настройки в коде

Все основные параметры задаются через константы в начале файла:

```cpp
#define ARM_LENGTH_MM      200.0   // Длина плеча в мм
#define PARKING_ANGLE_DEG   5.0    // Угол парковки в градусах
#define PIN_STEP           33      // Пин STEP
#define PIN_DIR            23      // Пин DIR
#define PIN_MICROSTEP_EN   19      // Пин микрошага
```

## Режимы работы

- **TRACKING** (зеленый мигающий): Автоматическое отслеживание звезд
- **PARKING** (красный мигающий): Возврат в нулевое положение
- **PARKED** (желтый постоянный): Припаркован, ожидание команды

## Управление

- **Короткое нажатие кнопки**:
  - В режиме TRACKING → переход в PARKING
  - В режиме PARKED → переход в TRACKING
  
- **Удержание кнопки**:
  - Ручное управление парковкой (вращение в направлении нулевого положения)

## Будущие улучшения

- Подключение концевого датчика для точной парковки
- WiFi/web-интерфейс для удаленного управления

## Лицензия

MIT

